(window.webpackJsonp=window.webpackJsonp||[]).push([[315],{1357:function(e,t,n){(t=n(370)(!1)).push([e.i,"",""]),e.exports=t},1798:function(e,t,n){"use strict";n.r(t),n.d(t,"AuditApp",(function(){return E}));var o,a,i=n(366),s=n(382),r=n(385),c=n(854),l=n(725);n(857);function d(){return new Date}!function(e){e.Weekly="Weekly",e.Monthly="Monthly",e.Trimestrial="Trimestrial",e.Yearly="Yearly"}(o||(o={})),function(e){e.Today="today",e.Week="7days",e.Month="30days",e.Trimester="90days",e.Custom="custom"}(a||(a={}));var u=n(463),p=n(393),g=n(371),b=n(373),h=n(396),m=n(649),f=n(433),O=n(6),j=n(367),k=n(0);const y={[a.Today]:()=>d(),[a.Week]:()=>Object(u.subDays)(d(),7),[a.Month]:()=>Object(u.subDays)(d(),30),[a.Trimester]:()=>Object(u.subDays)(d(),90)},v=e=>e.toISOString();function S(e){const{dateRange:t,downloadStarted:n,selection:o}=e,s=n||o===a.Custom&&(void 0===(null==t?void 0:t.from)||void 0===(null==t?void 0:t.to)),r=s?"#":"".concat(Object(k.getBaseUrl)(),"/api/audit_logs/download?").concat(function(e,t){return e===a.Custom?(null==t?void 0:t.to)&&(null==t?void 0:t.from)?new URLSearchParams({from:v(Object(u.startOfDay)(t.from)),to:v(Object(u.endOfDay)(t.to))}).toString():"":new URLSearchParams({from:v(Object(u.startOfDay)(y[e]())),to:v(d())}).toString()}(o,t));return i.createElement(i.Fragment,null,i.createElement("a",{className:j("button button-primary",{disabled:s}),download:"audit_logs.json",onClick:s?void 0:e.onStartDownload,href:r,rel:"noopener noreferrer",target:"_blank"},Object(O.k)("download_verb")),n&&i.createElement("div",{className:"spacer-top"},i.createElement("p",null,Object(O.k)("audit_logs.download_start.sentence.1")),i.createElement("p",null,Object(O.k)("audit_logs.download_start.sentence.2")),i.createElement("br",null),i.createElement("p",null,Object(O.k)("audit_logs.download_start.sentence.3"))))}const _={[o.Weekly]:7,[o.Monthly]:30,[o.Trimestrial]:90,[o.Yearly]:365};function w(e){const{dateRange:t,downloadStarted:n,housekeepingPolicy:o,selection:s}=e;return i.createElement("div",{className:"page page-limited",id:"marketplace-page"},i.createElement(h.a,{suggestions:"audit-logs"}),i.createElement(p.a,{title:Object(O.k)("audit_logs.page")}),i.createElement("header",{className:"page-header"},i.createElement("h1",{className:"page-title"},Object(O.k)("audit_logs.page"))),i.createElement("p",{className:"big-spacer-bottom"},Object(O.k)("audit_logs.page.description.1"),i.createElement("br",null),i.createElement(g.FormattedMessage,{id:"audit_logs.page.description.2",defaultMessage:Object(O.k)("audit_logs.page.description.2"),values:{housekeeping:Object(O.k)("audit_logs.housekeeping_policy",o),link:i.createElement(b.c,{to:{pathname:"/admin/settings",query:{category:"housekeeping"},hash:"#auditLogs"}},Object(O.k)("audit_logs.page.description.link"))}})),i.createElement("div",{className:"huge-spacer-bottom"},i.createElement("h2",{className:"big-spacer-bottom"},Object(O.k)("audit_logs.download")),i.createElement("ul",null,(e=>{const t=[a.Today,a.Week];return _[e]>=30&&t.push(a.Month),_[e]>=90&&t.push(a.Trimester),t.push(a.Custom),t})(o).map(t=>i.createElement("li",{key:t,className:"spacer-bottom"},i.createElement(f.a,{checked:s===t,onCheck:e.handleOptionSelection,value:t},Object(O.k)("audit_logs.range_option",t))))),i.createElement(m.a,{className:"big-spacer-left",onChange:e.handleDateSelection,minDate:Object(u.subDays)(d(),_[o]),maxDate:d(),value:t})),i.createElement(S,{dateRange:t,downloadStarted:n,onStartDownload:e.handleStartDownload,selection:s}))}class E extends i.PureComponent{constructor(){super(...arguments),this.state={downloadStarted:!1,selection:a.Today},this.handleDateSelection=e=>this.setState({dateRange:e,downloadStarted:!1,selection:a.Custom}),this.handleOptionSelection=e=>this.setState({dateRange:void 0,downloadStarted:!1,selection:e}),this.handleStartDownload=()=>{setTimeout(()=>{this.setState({downloadStarted:!0})},0)}}componentDidMount(){const{hasGovernanceExtension:e}=this.props;e&&this.props.fetchValues(["sonar.dbcleaner.auditHousekeeping"])}render(){const{hasGovernanceExtension:e,auditHousekeepingPolicy:t}=this.props;return e?i.createElement(w,Object.assign({handleDateSelection:this.handleDateSelection,handleOptionSelection:this.handleOptionSelection,handleStartDownload:this.handleStartDownload,housekeepingPolicy:t||o.Monthly},this.state)):null}}const x={fetchValues:l.c};t.default=Object(s.b)(e=>{const t=Object(r.getGlobalSettingValue)(e,"sonar.dbcleaner.auditHousekeeping"),{adminPages:n}=Object(r.getAppState)(e),o=Boolean(null==n?void 0:n.find(e=>e.key===c.a.GovernanceConsole));return{auditHousekeepingPolicy:null==t?void 0:t.value,hasGovernanceExtension:o}},x)(E)},396:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(366),a=n(435);function i({suggestions:e}){return o.createElement(a.a.Consumer,null,({addSuggestions:t,removeSuggestions:n})=>o.createElement(s,{addSuggestions:t,removeSuggestions:n,suggestions:e}))}class s extends o.PureComponent{componentDidMount(){this.props.addSuggestions(this.props.suggestions)}componentDidUpdate(e){e.suggestions!==this.props.suggestions&&(this.props.removeSuggestions(this.props.suggestions),this.props.addSuggestions(e.suggestions))}componentWillUnmount(){this.props.removeSuggestions(this.props.suggestions)}render(){return null}}},409:function(e,t,n){var o=n(440);e.exports=function(e){return e?(e=o(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}},433:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(367),a=n(366);n(439);class i extends a.PureComponent{constructor(){super(...arguments),this.handleClick=e=>{e.preventDefault(),this.props.disabled||this.props.onCheck(this.props.value)}}render(){const{className:e,checked:t,children:n,disabled:i}=this.props;return a.createElement("a",{"aria-checked":t,className:o("display-inline-flex-center link-radio",e,{disabled:i}),href:"#",onClick:this.handleClick,role:"radio"},a.createElement("i",{className:o("icon-radio","spacer-right",{"is-checked":t})}),n)}}},439:function(e,t,n){var o=n(369),a=n(446);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var i={insert:"head",singleton:!1},s=(o(a,i),a.locals?a.locals:{});e.exports=s},446:function(e,t,n){(t=n(370)(!1)).push([e.i,'.icon-radio{position:relative;display:inline-block;vertical-align:top;width:14px;height:14px;margin:1px;border:1px solid #cdcdcd;border-radius:12px;box-sizing:border-box;transition:border-color .3s ease;flex-shrink:0}.icon-radio:after{position:absolute;top:2px;left:2px;display:block;width:8px;height:8px;border-radius:8px;background-color:#236a97;content:"";opacity:0;transition:opacity .3s ease}.link-radio .icon-radio.is-checked:after{opacity:1}.link-radio{border-bottom:none}.link-radio,.link-radio:not(.disabled):active,.link-radio:not(.disabled):focus,.link-radio:not(.disabled):hover{color:inherit}.link-radio:not(.disabled):hover>.icon-radio{border-color:#4b9fd5}.link-radio.disabled,.link-radio.disabled:hover,.link-radio.disabled label{color:#bbb;cursor:not-allowed}.link-radio.disabled .icon-radio:after{background-color:#ebebeb}',""]),e.exports=t},468:function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return u})),n.d(t,"f",(function(){return p})),n.d(t,"g",(function(){return g})),n.d(t,"a",(function(){return b})),n.d(t,"c",(function(){return h})),n.d(t,"b",(function(){return m}));var o=n(24),a=n.n(o),i=n(381),s=n(451),r=n(4);function c(e){return Object(r.d)("/api/settings/list_definitions",{component:e}).then(e=>e.definitions,i.a)}function l(e){return Object(r.d)("/api/settings/values",e).then(e=>[...e.settings,...e.setSecuredSettings.map(e=>({key:e}))])}function d(e,t,n){const{key:o}=e,i={key:o,component:n};return Object(s.m)(e)&&e.multiValues?i.values=t:"PROPERTY_SET"===e.type?i.fieldValues=t.map(e=>a()(e,e=>null==e)).map(JSON.stringify):i.value=t,Object(r.i)("/api/settings/set",i)}function u(e){return Object(r.i)("/api/settings/set",e).catch(i.a)}function p(e){return Object(r.i)("/api/settings/reset",e)}function g(e,t,n){return Object(r.i)("/api/emails/send",{to:e,subject:t,message:n})}function b(){return Object(r.d)("/api/settings/check_secret_key").catch(i.a)}function h(){return Object(r.j)("/api/settings/generate_secret_key").catch(i.a)}function m(e){return Object(r.j)("/api/settings/encrypt",{value:e}).catch(i.a)}},725:function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return g})),n.d(t,"a",(function(){return b})),n.d(t,"e",(function(){return h})),n.d(t,"d",(function(){return m}));var o=n(468),a=n(6),i=n(4),s=n(448),r=n(385),c=n(451),l=n(817),d=n(754),u=n(756);function p(e){return t=>Object(o.d)(e).then(e=>{const n=e.filter(e=>"LICENSE"!==e.type);t(Object(l.g)(n))})}function g(e,t){return n=>Object(o.e)({keys:e.join(),component:t}).then(o=>{n(Object(u.c)(e,o,t)),n(Object(s.c)())})}function b(e){return(t,n)=>{const o=n(),i=Object(r.getSettingsAppDefinition)(o,e),s=Object(r.getSettingsAppChangedValue)(o,e);if(Object(c.o)(i,s))return void 0===i.defaultValue?t(Object(d.d)(e,Object(a.k)("settings.state.value_cant_be_empty_no_default"))):t(Object(d.d)(e,Object(a.k)("settings.state.value_cant_be_empty"))),!1;if(function(e){return["sonar.core.serverBaseURL","sonar.auth.github.apiUrl","sonar.auth.github.webUrl","sonar.auth.gitlab.url","sonar.lf.gravatarServerUrl","sonar.lf.logoUrl","sonar.auth.saml.loginUrl"].includes(e.key)}(i))try{new URL(s)}catch(n){return t(Object(d.d)(e,Object(a.l)("settings.state.url_not_valid",s))),!1}if("JSON"===i.type)try{JSON.parse(s)}catch(n){return t(Object(d.d)(e,n.message)),!1}return t(Object(d.h)(e)),!0}}function h(e,t){return(n,i)=>{n(Object(d.i)(e));const s=i(),l=Object(r.getSettingsAppDefinition)(s,e),p=Object(r.getSettingsAppChangedValue)(s,e);return Object(c.o)(l,p)?(n(Object(d.d)(e,Object(a.k)("settings.state.value_cant_be_empty"))),n(Object(d.j)(e)),Promise.reject()):Object(o.h)(l,p,t).then(()=>Object(o.e)({keys:e,component:t})).then(o=>{n(Object(u.c)([e],o,t)),n(Object(d.a)(e)),n(Object(d.h)(e)),n(Object(d.j)(e))}).catch(f(e,n))}}function m(e,t){return n=>(n(Object(d.i)(e)),Object(o.f)({keys:e,component:t}).then(()=>Object(o.e)({keys:e,component:t})).then(o=>{o.length>0?n(Object(u.c)([e],o,t)):n(Object(u.c)([e],[],t)),n(Object(d.h)(e)),n(Object(d.j)(e))}).catch(f(e,n)))}function f(e,t){return n=>(t(Object(d.j)(e)),Object(i.g)(n).then(n=>(t(Object(d.d)(e,n)),Promise.reject())))}},854:function(e,t,n){"use strict";var o;n.d(t,"a",(function(){return o})),function(e){e.GovernanceConsole="governance/views_console"}(o||(o={}))},857:function(e,t,n){var o=n(369),a=n(1357);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var i={insert:"head",singleton:!1},s=(o(a,i),a.locals?a.locals:{});e.exports=s}}]);
//# sourceMappingURL=315.m.cb0d2f08.chunk.js.map
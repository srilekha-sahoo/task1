(window.webpackJsonp=window.webpackJsonp||[]).push([[355],{1808:function(e,t,a){"use strict";a.r(t),a.d(t,"PullRequestOverview",(function(){return M}));var i=a(470),n=a.n(i),s=a(696),c=a.n(s),l=a(367),o=a(366),r=a(382),m=a(578),d=a(384),v=a(379),p=a(386),u=a(6),h=a(377),b=a(452),f=a(524),g=a(385),E=a(633),w=a(1103),y=a(1104),N=a(1102),k=a(1127),O=(a(1099),a(656));var j=o.memo((function({className:e,measures:t,type:a}){const i=Object(O.i)(a),n=Object(h.findMeasure)(t,i);return n&&void 0!==n.value?o.createElement("div",{className:l(e,"display-flex-center")},o.createElement("span",{className:"huge"},Object(h.formatMeasure)(n.value,"PERCENT")),o.createElement("span",{className:"label flex-1 spacer-left text-right"},Object(u.k)("component_measures.facet_category.overall_category.estimated"))):null})),_=a(371),x=a(373),C=a(375),D=a(438),q=a(378);var B=o.memo((function({component:e,level:t}){const a="OK"===t,i=void 0===e.qualityGate?Object(q.D)():Object(q.C)(e.qualityGate.key);return o.createElement("div",{className:l("overview-quality-gate-badge-large small",{failed:!a,success:a})},o.createElement("div",{className:"display-flex-center"},o.createElement("span",null,Object(u.k)("overview.on_new_code_long")),o.createElement(d.a,{className:"little-spacer-left",overlay:o.createElement(_.FormattedMessage,{defaultMessage:Object(u.k)("overview.quality_gate.conditions_on_new_code"),id:"overview.quality_gate.conditions_on_new_code",values:{link:o.createElement(x.c,{to:i},Object(u.k)("overview.quality_gate"))}})},o.createElement(D.a,{fill:C.colors.transparentWhite,size:12}))),void 0!==t&&o.createElement("h3",{className:"huge-spacer-top huge"},Object(u.k)("metric.level",t)))}));class M extends o.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={loading:!1,measures:[]},this.conditionsHaveChanged=e=>{var t,a;const i=null!==(t=e.conditions)&&void 0!==t?t:[],n=null!==(a=this.props.conditions)&&void 0!==a?a:[],s=c()(i.filter(e=>"ERROR"===e.level),n.filter(e=>"ERROR"===e.level),e=>e.metric);return void 0===e.conditions&&void 0!==this.props.conditions||s.length>0},this.fetchBranchStatusData=()=>{const{branchLike:e,component:{key:t}}=this.props;this.props.fetchBranchStatus(e,t)},this.fetchBranchData=()=>{const{branchLike:e,component:{key:t},conditions:a}=this.props;this.setState({loading:!0});const i=void 0!==a?n()([...O.d,...a.filter(e=>"OK"!==e.level).map(e=>e.metric)]):O.d;Object(m.c)(t,i,Object(p.d)(e)).then(({component:e,metrics:t})=>{this.mounted&&e.measures&&this.setState({loading:!1,measures:Object(h.enhanceMeasuresWithMetrics)(e.measures||[],t)})},()=>{this.mounted&&this.setState({loading:!1})})}}componentDidMount(){this.mounted=!0,void 0===this.props.conditions?this.fetchBranchStatusData():this.fetchBranchData()}componentDidUpdate(e){this.conditionsHaveChanged(e)&&this.fetchBranchData()}componentWillUnmount(){this.mounted=!1}render(){const{branchLike:e,component:t,conditions:a,ignoredConditions:i,status:n}=this.props,{loading:s,measures:c}=this.state;if(s)return o.createElement("div",{className:"page page-limited"},o.createElement("i",{className:"spinner"}));if(void 0===a)return null;const r=a.filter(e=>"ERROR"===e.level).map(e=>Object(h.enhanceConditionWithMeasure)(e,c)).filter(b.a);return o.createElement("div",{className:"page page-limited"},o.createElement("div",{className:l("pr-overview",{"has-conditions":r.length>0})},i&&o.createElement(v.a,{className:"big-spacer-bottom",display:"inline",variant:"info"},o.createElement("span",{className:"text-middle"},Object(u.k)("overview.quality_gate.ignored_conditions")),o.createElement(d.a,{className:"spacer-left",overlay:Object(u.k)("overview.quality_gate.ignored_conditions.tooltip")})),o.createElement("div",{className:"display-flex-row"},o.createElement("div",{className:"big-spacer-right"},o.createElement("h2",{className:"overview-panel-title spacer-bottom small display-inline-flex-center"},Object(u.k)("overview.quality_gate"),o.createElement(d.a,{className:"little-spacer-left",overlay:o.createElement("div",{className:"big-padded-top big-padded-bottom"},Object(u.k)("overview.quality_gate.help"))})),o.createElement(B,{component:t,level:n})),r.length>0&&o.createElement("div",{className:"pr-overview-failed-conditions big-spacer-right"},o.createElement("h2",{className:"overview-panel-title spacer-bottom small"},Object(u.k)("overview.failed_conditions")),o.createElement(k.b,{branchLike:e,collapsible:!0,component:t,failedConditions:r})),o.createElement("div",{className:"flex-1"},o.createElement("h2",{className:"overview-panel-title spacer-bottom small"},Object(u.k)("overview.measures")),o.createElement("div",{className:"overview-panel-content"},[E.b.Bug,E.b.Vulnerability,E.b.SecurityHotspot,E.b.CodeSmell].map(a=>o.createElement("div",{className:"overview-measures-row display-flex-row",key:a},o.createElement("div",{className:"overview-panel-big-padded flex-1 small display-flex-center"},o.createElement(w.a,{branchLike:e,component:t,measures:c,type:a,useDiffMetric:!0})),o.createElement("div",{className:"overview-panel-big-padded overview-measures-aside display-flex-center"},o.createElement(y.a,{branchLike:e,component:t,measures:c,type:a,useDiffMetric:!0})))),[O.c.Coverage,O.c.Duplication].map(a=>o.createElement("div",{className:"overview-measures-row display-flex-row",key:a},o.createElement("div",{className:"overview-panel-big-padded flex-1 small display-flex-center"},o.createElement(N.a,{branchLike:e,component:t,measures:c,type:a,useDiffMetric:!0})),o.createElement(j,{className:"overview-panel-big-padded overview-measures-aside text-right overview-measures-emphasis",measures:c,type:a}))))))))}}const R={fetchBranchStatus:f.c};t.default=Object(r.b)((e,{branchLike:t,component:a})=>{const{conditions:i,ignoredConditions:n,status:s}=Object(g.getBranchStatusByBranchLike)(e,a.key,t);return{conditions:i,ignoredConditions:n,status:s}},R)(M)},696:function(e,t,a){var i=a(420),n=a(485),s=a(22),c=a(450),l=a(413),o=a(665),r=c((function(e,t){var a=o(t);return l(a)&&(a=void 0),l(e)?i(e,n(t,1,l,!0),s(a,2)):[]}));e.exports=r}}]);
//# sourceMappingURL=355.m.ca64d2a0.chunk.js.map
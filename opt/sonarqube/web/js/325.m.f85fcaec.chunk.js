(window.webpackJsonp=window.webpackJsonp||[]).push([[325],{1744:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return s}));var a=n(366),c=n(907);function s(e){return a.createElement(c.a,Object.assign({setup:!1},e))}},398:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));var a=n(366),c=n(371),s=n(21);const r={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"};function i({children:e,date:t}){return a.createElement(c.FormattedDate,Object.assign({value:Object(s.b)(t)},r),e)}},416:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(463),c=n(366),s=n(371),r=n(21),i=n(6),m=n(398);function l(e){const{children:t=(e=>e),date:n,hourPrecision:l}=e;let u=t;if(!n)return c.createElement(c.Fragment,null,t(Object(i.k)("never")));n&&l&&Object(a.differenceInHours)(Date.now(),n)<1&&(u=()=>t(Object(i.k)("less_than_1_hour_ago")));const o=Object(r.b)(n);return c.createElement(m.a,{date:o},e=>c.createElement("span",{title:e},c.createElement(s.FormattedRelative,{value:o},u)))}},551:function(e,t,n){"use strict";n.d(t,"g",(function(){return s})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return m})),n.d(t,"a",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return o})),n.d(t,"h",(function(){return d}));var a=n(381),c=n(4);function s(e){return Object(c.i)("/api/system/change_log_level",{level:e}).catch(a.a)}function r(){return Object(c.d)("/api/system/info").catch(a.a)}function i(){return Object(c.d)("/api/system/status")}function m(){return Object(c.d)("/api/system/upgrades")}function l(){return Object(c.d)("/api/system/db_migration_status")}function u(){return Object(c.j)("/api/system/migrate_db")}function o(){return Object(c.i)("/api/system/restart").catch(a.a)}function d(){return Object(c.m)(i,{max:-1,slowThreshold:-15},({status:e})=>"UP"===e)}},595:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(366),c=n(371),s=n(21);const r={hour:"numeric",minute:"numeric"},i={hour:"numeric",minute:"numeric",second:"numeric"};function m({children:e,date:t,long:n}){return a.createElement(c.FormattedTime,Object.assign({value:Object(s.b)(t)},n?i:r),e)}},907:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(367),c=n(366),s=n(393),r=n(371),i=n(551),m=n(509),l=n(368),u=n(416),o=n(595),d=n(6),h=n(0),g=n(378);n(908);class b extends c.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={},this.fetchStatus=()=>{(this.props.setup?this.fetchMigrationState():this.fetchSystemStatus()).catch(()=>{this.mounted&&this.setState({message:void 0,startedAt:void 0,state:void 0,status:"OFFLINE"})})},this.fetchSystemStatus=()=>Object(i.c)().then(({status:e})=>{this.mounted&&(this.setState({status:e}),"STARTING"===e?(this.setState({wasStarting:!0}),this.scheduleRefresh()):"UP"===e?this.state.wasStarting&&this.loadPreviousPage():this.scheduleRefresh())}),this.fetchMigrationState=()=>Object(i.a)().then(({message:e,startedAt:t,state:n})=>{this.mounted&&(this.setState({message:e,startedAt:t,state:n}),"MIGRATION_SUCCEEDED"===n?this.loadPreviousPage():"NO_MIGRATION"!==n&&this.scheduleRefresh())}),this.scheduleRefresh=()=>{this.interval=window.setTimeout(this.fetchStatus,5e3)},this.loadPreviousPage=()=>{setInterval(()=>{window.location.href=Object(g.F)(this.props.location)},2500)},this.handleMigrateClick=()=>{Object(i.e)().then(({message:e,startedAt:t,state:n})=>{this.mounted&&this.setState({message:e,startedAt:t,state:n})},()=>{})}}componentDidMount(){this.mounted=!0,this.fetchStatus()}componentWillUnmount(){this.mounted=!1,this.interval&&window.clearInterval(this.interval)}render(){const{state:e,status:t}=this.state;return c.createElement(c.Fragment,null,c.createElement(s.a,{defaultTitle:Object(d.k)("maintenance.page"),defer:!1}),c.createElement("div",{className:"page-wrapper-simple",id:"bd"},c.createElement("div",{className:a("page-simple",{"panel-warning":"MIGRATION_REQUIRED"===e}),id:"nonav"},"OFFLINE"===t&&c.createElement(c.Fragment,null,c.createElement("h1",{className:"maintenance-title text-danger"},c.createElement(m.a,{message:Object(d.k)("maintenance.is_offline")})),!Object(h.isSonarCloud)()&&c.createElement("p",{className:"maintenance-text"},Object(d.k)("maintenance.sonarqube_is_offline.text")),c.createElement("p",{className:"maintenance-text text-center"},c.createElement("a",{href:Object(h.getBaseUrl)()+"/"},Object(d.k)("maintenance.try_again")))),"UP"===t&&c.createElement(c.Fragment,null,c.createElement("h1",{className:"maintenance-title"},c.createElement(m.a,{message:Object(d.k)("maintenance.is_up")})),c.createElement("p",{className:"maintenance-text text-center"},Object(d.k)("maintenance.all_systems_opetational")),c.createElement("p",{className:"maintenance-text text-center"},c.createElement("a",{href:Object(h.getBaseUrl)()+"/"},Object(d.k)("layout.home")))),"STARTING"===t&&c.createElement(c.Fragment,null,c.createElement("h1",{className:"maintenance-title"},c.createElement(m.a,{message:Object(d.k)("maintenance.is_starting")})),c.createElement("p",{className:"maintenance-spinner"},c.createElement("i",{className:"spinner"}))),"DOWN"===t&&c.createElement(c.Fragment,null,c.createElement("h1",{className:"maintenance-title text-danger"},c.createElement(m.a,{message:Object(d.k)("maintenance.is_down")})),c.createElement("p",{className:"maintenance-text"},Object(d.k)("maintenance.sonarqube_is_down.text")),c.createElement("p",{className:"maintenance-text text-center"},c.createElement("a",{href:Object(h.getBaseUrl)()+"/"},Object(d.k)("maintenance.try_again")))),("DB_MIGRATION_NEEDED"===t||"DB_MIGRATION_RUNNING"===t)&&c.createElement(c.Fragment,null,c.createElement("h1",{className:"maintenance-title"},c.createElement(m.a,{message:Object(d.k)("maintenance.is_under_maintenance")})),c.createElement("p",{className:"maintenance-text"},c.createElement(r.FormattedMessage,{defaultMessage:Object(d.k)("maintenance.sonarqube_is_under_maintenance.1"),id:"maintenance.sonarqube_is_under_maintenance.1",values:{link:c.createElement("a",{href:"https://www.sonarlint.org/?referrer=sonarqube-maintenance",target:"_blank",rel:"noopener noreferrer"},Object(d.k)("maintenance.sonarqube_is_under_maintenance_link.1"))}})),c.createElement("p",{className:"maintenance-text"},c.createElement(r.FormattedMessage,{defaultMessage:Object(d.k)("maintenance.sonarqube_is_under_maintenance.2"),id:"maintenance.sonarqube_is_under_maintenance.2",values:{link:c.createElement("a",{href:"https://redirect.sonarsource.com/doc/upgrading.html",target:"_blank",rel:"noopener noreferrer"},Object(d.k)("maintenance.sonarqube_is_under_maintenance_link.2"))}}))),"NO_MIGRATION"===e&&c.createElement(c.Fragment,null,c.createElement("h1",{className:"maintenance-title"},Object(d.k)("maintenance.database_is_up_to_date")),c.createElement("p",{className:"maintenance-text text-center"},c.createElement("a",{href:Object(h.getBaseUrl)()+"/"},Object(d.k)("layout.home")))),"MIGRATION_REQUIRED"===e&&c.createElement(c.Fragment,null,c.createElement("h1",{className:"maintenance-title"},Object(d.k)("maintenance.upgrade_database")),c.createElement("p",{className:"maintenance-text"},Object(d.k)("maintenance.upgrade_database.1")),c.createElement("p",{className:"maintenance-text"},Object(d.k)("maintenance.upgrade_database.2")),c.createElement("p",{className:"maintenance-text"},Object(d.k)("maintenance.upgrade_database.3")),c.createElement("div",{className:"maintenance-spinner"},c.createElement(l.a,{id:"start-migration",onClick:this.handleMigrateClick},Object(d.k)("maintenance.upgrade")))),"NOT_SUPPORTED"===e&&c.createElement(c.Fragment,null,c.createElement("h1",{className:"maintenance-title text-danger"},Object(d.k)("maintenance.migration_not_supported")),c.createElement("p",null,Object(d.k)("maintenance.migration_not_supported.text"))),"MIGRATION_RUNNING"===e&&c.createElement(c.Fragment,null,c.createElement("h1",{className:"maintenance-title"},Object(d.k)("maintenance.database_migration")),this.state.message&&c.createElement("p",{className:"maintenance-text text-center"},this.state.message),this.state.startedAt&&c.createElement("p",{className:"maintenance-text text-center"},Object(d.k)("background_tasks.table.started")," ",c.createElement(u.a,{date:this.state.startedAt}),c.createElement("br",null),c.createElement("small",{className:"text-muted"},c.createElement(o.a,{date:this.state.startedAt,long:!0}))),c.createElement("p",{className:"maintenance-spinner"},c.createElement("i",{className:"spinner"}))),"MIGRATION_SUCCEEDED"===e&&c.createElement(c.Fragment,null,c.createElement("h1",{className:"maintenance-title text-success"},Object(d.k)("maintenance.database_is_up_to_date")),c.createElement("p",{className:"maintenance-text text-center"},c.createElement("a",{href:Object(h.getBaseUrl)()+"/"},Object(d.k)("layout.home")))),"MIGRATION_FAILED"===e&&c.createElement(c.Fragment,null,c.createElement("h1",{className:"maintenance-title text-danger"},Object(d.k)("maintenance.upgrade_failed")),c.createElement("p",{className:"maintenance-text"},Object(d.k)("maintenance.upgrade_failed.text"))))))}}},908:function(e,t,n){var a=n(369),c=n(909);"string"==typeof(c=c.__esModule?c.default:c)&&(c=[[e.i,c,""]]);var s={insert:"head",singleton:!1},r=(a(c,s),c.locals?c.locals:{});e.exports=r},909:function(e,t,n){(t=n(370)(!1)).push([e.i,".maintenance-title{margin-bottom:40px;line-height:1.5;font-size:24px;font-weight:300;text-align:center}.maintenance-text{margin-bottom:16px;line-height:1.5;font-size:16px;font-weight:300}.maintenance-spinner{margin-top:40px;text-align:center}",""]),e.exports=t}}]);
//# sourceMappingURL=325.m.f85fcaec.chunk.js.map